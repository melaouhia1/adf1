{
	"name": "dataflow5",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "sqlbuilding",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "Jsonbuilding1",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "DerivedColumn1"
				}
			],
			"script": "source(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'SELECT\\n                      \\'add\\'                                                                              AS Operator\\n\t\t\t\t\t  ,SYSDATETIME()                                                                     as ETL_Load_Date_Time\\n                    ,\\'building\\'                                                                          as Functions\\n\t\t\t\t\t,[Building_ExternalBuildingId]                                                   as ExternalBuildingId\\n                   \\n      ,[Building_BuildingName_local]\\n      ,[Building_BuildingName_en]\\n      ,[Building_Height]\\n      ,[Building_StreetAddress_En]\\n      ,[Building_StreetAddress_Local]\\n      ,[Building_Suburb_En]\\n      ,[Building_Suburb_Local]\\n      ,[Building_City_En]\\n      ,[Building_City_Local]\\n      ,[Building_Postcode]\\n      ,[Building_MainTypeViewId]\\n      ,[Building_MainTypeName_En]\\n      ,[Building_MainTypeName_Local]\\n      ,[Building_SubTypeViewId]\\n      ,[Building_SubTypeName_En]\\n      ,[Building_SubTypeName_Local]\\n      ,[Building_BuildingNo]\\n      ,[Building_IsStandbybuilding]\\n      ,[Building_CostingNo]\\n      ,[Building_CustomerNo]\\n      ,[Building_SumOfTotalUnits]\\n      ,[Building_SumOfUnitsInService]\\n      ,[Building_QuickTurnover]\\n      ,[Building_Latitude]\\n      ,[Building_Longitude]\\n      ,[Building_OfficeViewId]\\n      ,[Building_OfficeName_En]\\n      ,[Building_OfficeName_Local]\\n      ,[Building_TKManagerEmployeeViewId]\\n      ,[Building_TKManagerEmployeeExternalId]\\n      ,[Building_TKManagerName]\\n      ,[Building_IsRepairCorres]\\n      ,[Building_IsCalendar]\\n      ,[Building_IsGeneralCorres]\\n      ,[Building_IsCard]\\n      ,[Building_IsMonthlyReport]\\n      ,[Building_UnitsScheduleHours]\\n      ,[Building_UnitsScheduleHoursViewId]\\n      ,[Building_UnitsScheduleTime]\\n      ,[Building_UnitsScheduleTimeViewId]\\n      ,[Building_UnitsScheduleDay]\\n      ,[Building_UnitsScheduleDayViewId]\\n      ,[Building_UnitsScheduleDayFrequency]\\n      ,[Building_TargetCallRate]\\n      ,[Array_RunInfo]\\n      ,[RunInfo_RunTypeViewId]\\n      ,[RunInfo_RunTypeName]\\n      ,[RunInfo_RunViewId]\\n      ,[RunInfo_RunName]\\n      ,[RunInfo_BHSWPResponse]\\n      ,[RunInfo_BHStopResponse]\\n      ,[RunInfo_BHOthersResponse]\\n      ,[RunInfo_AHSWPResponse]\\n      ,[RunInfo_AHStopResponse]\\n      ,[RunInfo_AHOthersResponse]\\n      ,[RunInfo_Notes]\\n      ,[RunInfo_PropertyManagerEmployeeViewId]\\n      ,[RunInfo_PropertyManagerEmployeeName]\\n      ,[Array_BusinessHourContactInfo]\\n      ,[BusinessHourContactInfo_BHSiteContact]\\n      ,[BusinessHourContactInfo_BHContactLocation_En]\\n      ,[BusinessHourContactInfo_BHContactLocation_Local]\\n      ,[BusinessHourContactInfo_BHContactPhone1]\\n      ,[BusinessHourContactInfo_BHContactPhone2]\\n      ,[BusinessHourContactInfo_BHContactMobile]\\n      ,[BusinessHourContactInfo_BHContactFax]\\n      ,[BusinessHourContactInfo_BHContactRoleViewId]\\n      ,[BusinessHourContactInfo_BHContactRoleName]\\n      ,[Array_AfterHourContactInfo]\\n      ,[AfterHourContactInfo_AHSiteContact]\\n      ,[AfterHourContactInfo_AHContactLocation_En]\\n      ,[AfterHourContactInfo_AHContactLocation_Local]\\n      ,[AfterHourContactInfo_AHContactPhone1]\\n      ,[AfterHourContactInfo_AHContactMobile]\\n      ,[AfterHourContactInfo_AHContactFax]\\n      ,[AfterHourContactInfo_AHContactRoleViewId]\\n      ,[AfterHourContactInfo_AHContactRoleViewName]\\n      ,[AfterHourContactInfo_AHContactAccessCode]\\n      ,[Array_BuildingContactInfo]\\n      ,[BuildingContactInfo_ContactViewId]\\n      ,[BuildingContactInfo_ContactExternalId]\\n      ,[BuildingContactInfo_ContactName]\\n      ,[BuildingContactInfo_IsBusinessHours]\\n      ,[Building_VFMCustomerName_En]\\n      ,[Building_VFMCustomerName_Local]\\n      ,[Building_VFMCustomerMail]\\n      ,[Building_VFMMailTemplateSubject]\\n      ,[Building_VFMMailTemplateContent]\\n      ,[Building_IsCustomisedMail]\\n      ,[Building_ReportFrequencyViewId]\\n      ,[Building_ReportFrequency]\\n      ,[Building_ReportTypeViewId]\\n      ,[Building_ReportType]\\n      ,[Building_IsReportInvoice]\\n      ,[Building_ReportSendTo]\\n      ,[Building_ReportAuditRequired]\\n      ,[Building_ReportAuditDetail]\\n      ,[Building_ReportServiceDockets]\\n      ,[Building_FromProjectId]\\n      ,[Building_FromProjectLabel]\\n      ,[Array_BuildingCustomerInfo]\\n      ,[BuildingCustomerInfo_CustomerViewId]\\n      ,[BuildingCustomerInfo_CustomerExternalId]\\n      ,[BuildingCustomerInfo_CustomerName]\\n      ,[Array_State]\\n      ,[State_ViewId]\\n      ,[State_Name]\\n      ,[Builiding_TimeZone]\\n      ,[Builiding_CustomerCode]\\n\t\t\t\t\t\\n\t\t\t\t\tFROM [customer].[Building] ',\n\tformat: 'query') ~> source1\nsource1 derive(ExternalBuildingId = Building_ExternalBuildingId,\n\t\tBuilding_BuildingName_local = Building_BuildingName_local,\n\t\tBuildingName_en = Building_BuildingName_en,\n\t\tHeight = Building_Height,\n\t\tStreetAddress = Building_StreetAddress_En,\n\t\tSuburb = Building_Suburb_En,\n\t\tCity = Building_City_En,\n\t\tPostcode = Building_Postcode,\n\t\tMainTypeViewId = Building_MainTypeViewId,\n\t\tMainTypeName_En = Building_MainTypeName_En,\n\t\tMainTypeName_Local = Building_MainTypeName_Local,\n\t\tSubTypeViewId = Building_SubTypeViewId,\n\t\tSubTypeName_En = Building_SubTypeName_En,\n\t\tSubTypeName_Local = Building_SubTypeName_Local,\n\t\tBuildingNo = Building_BuildingNo,\n\t\tIsStandbybuilding = Building_IsStandbybuilding,\n\t\tCostingNo = Building_CostingNo,\n\t\tCustomerNo = Building_CustomerNo,\n\t\tSumOfTotalUnits = Building_SumOfTotalUnits,\n\t\tSumOfUnitsInService = Building_SumOfUnitsInService,\n\t\tQuickTurnover = Building_QuickTurnover,\n\t\tLatitude = Building_Latitude,\n\t\tLongitude = Building_Longitude,\n\t\tOfficeViewId = Building_OfficeViewId,\n\t\tOfficeName_En = Building_OfficeName_En,\n\t\tOfficeName_Local = Building_OfficeName_Local,\n\t\tTKManagerEmployeeViewId = Building_TKManagerEmployeeViewId,\n\t\tTKManagerEmployeeExternalId = Building_TKManagerEmployeeExternalId,\n\t\tTKManagerName = Building_TKManagerName,\n\t\tIsRepairCorres = Building_IsRepairCorres,\n\t\tIsCalendar = Building_IsCalendar,\n\t\tIsGeneralCorres = Building_IsGeneralCorres,\n\t\tIsCard = Building_IsCard,\n\t\tIsMonthlyReport = Building_IsMonthlyReport,\n\t\tUnitsScheduleHours = Building_UnitsScheduleHours,\n\t\tUnitsScheduleHoursViewId = Building_UnitsScheduleHoursViewId,\n\t\tUnitsScheduleTime = Building_UnitsScheduleTime,\n\t\tUnitsScheduleTimeViewId = Building_UnitsScheduleTimeViewId,\n\t\tUnitsScheduleDay = Building_UnitsScheduleDay,\n\t\tUnitsScheduleDayViewId = Building_UnitsScheduleDayViewId,\n\t\tUnitsScheduleDayFrequency = Building_UnitsScheduleDayFrequency,\n\t\tTargetCallRate = Building_TargetCallRate,\n\t\tRunInfo = @(RunTypeViewId=RunInfo_RunTypeViewId,\n\t\tRunTypeName=RunInfo_RunTypeName,\n\t\tRunViewId=RunInfo_RunViewId,\n\t\tRunName=RunInfo_RunName),\n\t\tBHSWPResponse = RunInfo_BHSWPResponse,\n\t\tBHOthersResponse = RunInfo_BHOthersResponse,\n\t\tAHSWPResponse = RunInfo_AHSWPResponse,\n\t\tAHStopResponse = RunInfo_AHStopResponse,\n\t\tAHOthersResponse = RunInfo_AHOthersResponse,\n\t\tNotes = RunInfo_Notes,\n\t\tPropertyManagerEmployeeViewId = RunInfo_PropertyManagerEmployeeViewId,\n\t\tPropertyManagerEmployeeName = RunInfo_PropertyManagerEmployeeName,\n\t\tBusinessHourContactInfo = @(BHSiteContact=BusinessHourContactInfo_BHSiteContact,\n\t\tBHContactLocation=BusinessHourContactInfo_BHContactLocation_En,\n\t\tBHContactPhone1=BusinessHourContactInfo_BHContactPhone1,\n\t\tBHContactPhone2=BusinessHourContactInfo_BHContactPhone2,\n\t\tBHContactMobile=BusinessHourContactInfo_BHContactMobile,\n\t\tBHContactFax=BusinessHourContactInfo_BHContactFax,\n\t\tBHContactRoleViewId=BusinessHourContactInfo_BHContactRoleViewId,\n\t\tBHContactRoleName=BusinessHourContactInfo_BHContactRoleName),\n\t\tAfterHourContactInfo = @(AHSiteContact=AfterHourContactInfo_AHSiteContact,\n\t\tAHContactLocation=AfterHourContactInfo_AHContactLocation_En,\n\t\tAHContactPhone1=AfterHourContactInfo_AHContactPhone1,\n\t\tAHContactMobile=AfterHourContactInfo_AHContactMobile,\n\t\tAHContactFax=AfterHourContactInfo_AHContactFax,\n\t\tAHContactRoleViewId=AfterHourContactInfo_AHContactRoleViewId,\n\t\tAHContactAccessCode=AfterHourContactInfo_AHContactAccessCode),\n\t\tBuildingContactInfo = @(ContactViewId=BuildingContactInfo_ContactViewId,\n\t\tContactExternalId=BuildingContactInfo_ContactExternalId,\n\t\tContactName=BuildingContactInfo_ContactName,\n\t\tIsBusinessHours=BuildingContactInfo_IsBusinessHours),\n\t\tVFMCustomerName_En = Building_VFMCustomerName_En,\n\t\tVFMCustomerName_ = Building_VFMCustomerName_En,\n\t\tVFMCustomerMail = Building_VFMCustomerMail,\n\t\tVFMMailTemplateSubject = Building_VFMMailTemplateSubject,\n\t\tVFMMailTemplateContent = Building_VFMMailTemplateContent,\n\t\tIsCustomisedMail = Building_IsCustomisedMail,\n\t\tReportFrequencyViewId = Building_ReportFrequencyViewId,\n\t\tReportFrequency = Building_ReportFrequency,\n\t\tReportTypeViewId = Building_ReportTypeViewId,\n\t\tReportType = Building_ReportType,\n\t\tIsReportInvoice = Building_IsReportInvoice,\n\t\tReportSendTo = Building_ReportSendTo,\n\t\tReportAuditRequired = Building_ReportAuditRequired,\n\t\tReportAuditDetail = Building_ReportAuditDetail,\n\t\tReportServiceDockets = Building_ReportServiceDockets,\n\t\tFromProjectId = Building_FromProjectId,\n\t\tFromProjectLabel = Building_FromProjectLabel,\n\t\tBuildingCustomerInfo = @(CustomerViewId=BuildingCustomerInfo_CustomerViewId,\n\t\tCustomerExternalId=BuildingCustomerInfo_CustomerExternalId,\n\t\tCustomerName=Building_VFMCustomerName_En)) ~> DerivedColumn1\nDerivedColumn1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:['buildingjson'],\n\tpartitionBy('hash', 1),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> sink1"
		}
	}
}